# デイリーダイジェスト - 2025-12-10

## 今日のフォーカス

### 優先度：高
（タスクなし）

### 通常タスク
（タスクなし）

### タグなしタスク
（タスクなし）

## 進捗

### 🔧 Recipe スケジュール修正完了 (18:20-18:30 JST)
- **カテゴリ**: maintenance
- **所要時間**: 10m
- **メモ**: 夜間自動化バッチのスケジュール最適化
- **対象 Recipe**:
  - Recipe 13: Nightly Wrap-up → **20:00 JST**
  - Recipe 14: Daily Digest Generator → **20:10 JST** (→ 20:12 に微調整)
  - Recipe 02: KB Index Rebuild → **20:30 JST**
  - Recipe 10: TODO.md Auto-sync → **20:40 JST**
- **曜日制限**: 日・月・水・金・土のみ（**火・木除外** = 夜勤シフト考慮）
- **Cron 式**: 各 Recipe で個別設定
  - Recipe 13: `0 20 * * 0,1,3,5,6`
  - Recipe 14: `12 20 * * 0,1,3,5,6`
  - Recipe 02: `30 20 * * 0,1,3,5,6`
  - Recipe 10: `40 20 * * 0,1,3,5,6`
- **効果**: 
  - 夜勤日（火・木）の自動実行を停止 → 睡眠時間確保
  - 10分間隔で順次実行 → 依存関係を考慮した設計
  - tomorrow.json → digest.md → KB rebuild → TODO sync の流れが確立

### 💡 tomorrow.json 統合完了 (20:46-21:04 JST)
- **カテゴリ**: core-work
- **所要時間**: 18m
- **メモ**: Recipe 13 → Recipe 14 のデータフロー完成
- **修正内容**:
  - `cortex/scripts/generate-daily-digest.mjs` に tomorrow.json 読み込み処理を追加
  - tomorrow_candidates を digest の「優先度：高」に自動配置
  - carryover_tasks が翌日に自動引き継がれる仕組み完成
- **テスト結果**:
  - 手動実行で tomorrow.json の 3候補が正しく埋め込まれることを確認
  - 2025-12-11-digest.md が tomorrow.json ベースで生成
- **次回検証**: 明日 20:12 JST の自動実行

## 振り返り

### 💡 学び

**Recipe スケジュール設計の重要性**
- 依存関係を考慮した順序: Recipe 13 → 14 → 02 → 10
- 10分間隔で tomorrow.json の書き込み完了を待つ設計
- 夜勤シフト（火・木）を Cron 式で除外する実装が有効

**n8n の Custom Cron の落とし穴**
- 複数の Recipe で同じ Cron 式 `0,10,30,40 20 * * 0,1,3,5,6` を使うと、全 Recipe が 4 回ずつ実行されてしまう
- 各 Recipe は **個別の時刻** で設定する必要がある:
  - Recipe 13: `0 20 ...` (20:00 のみ)
  - Recipe 14: `10 20 ...` (20:10 のみ)
  - Recipe 02: `30 20 ...` (20:30 のみ)
  - Recipe 10: `40 20 ...` (20:40 のみ)

**Recipe 02 の "Reload KB API" 問題**
- KB rebuild は成功しているが、"Reload KB API" ステップが失敗
- 原因: KB API プロセスが起動していない
- 対処: KB API が不要なら該当ノードを削除 or スキップ設定

### 🎯 次回への改善点

- Recipe 02 の "Reload KB API" ノードを削除 or 修正（明日対応）
- 今晩 20:00 以降の自動実行で全 Recipe が正常動作するか確認
- Recipe 実行ログを `/diagnose` で確認する習慣化

---

**生成日時**: 2025-12-10T09:26:17.065Z  
**ソース**: TODO.md（自動抽出）
